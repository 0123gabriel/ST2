2025-03-08 04:48:00, INFO: Using device: cpu
2025-03-08 04:48:00, INFO: Policy: st2 w/ global state
2025-03-08 04:48:00, INFO: human number: 4
2025-03-08 04:48:00, INFO: Randomize human's radius and preferred speed
2025-03-08 04:48:00, INFO: Training simulation: circle_crossing, test simulation: circle_crossing
2025-03-08 04:48:00, INFO: Square width: 10.0, circle width: 8.0
2025-03-08 04:48:00, INFO: Using model: Spatial_Temporal_Transformer(
  (Embedding): Embedding(
    (embedding): Linear(in_features=14, out_features=128, bias=True)
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (temporal_encoder): Encoder(
    (layers): ModuleList(
      (0): EncoderLayer(
        (attn_norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (attn): Attention(
          (qkv): Linear(in_features=128, out_features=384, bias=True)
          (out): Linear(in_features=128, out_features=128, bias=True)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (proj_dropout): Dropout(p=0.1, inplace=False)
          (softmax): Softmax(dim=-1)
          (avgpool): AdaptiveAvgPool1d(output_size=1)
        )
        (mlp_norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (mlp): Mlp(
          (fc1): Linear(in_features=128, out_features=512, bias=True)
          (fc2): Linear(in_features=512, out_features=128, bias=True)
          (act): GELU(approximate='none')
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
        (drop_path): DropPath()
      )
    )
    (encoder_norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
  )
  (Spatial_encoder): Encoder(
    (layers): ModuleList(
      (0): EncoderLayer(
        (attn_norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (attn): Attention(
          (qkv): Linear(in_features=128, out_features=384, bias=True)
          (out): Linear(in_features=128, out_features=128, bias=True)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (proj_dropout): Dropout(p=0.1, inplace=False)
          (softmax): Softmax(dim=-1)
          (avgpool): AdaptiveAvgPool1d(output_size=1)
        )
        (mlp_norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (mlp): Mlp(
          (fc1): Linear(in_features=128, out_features=512, bias=True)
          (fc2): Linear(in_features=512, out_features=128, bias=True)
          (act): GELU(approximate='none')
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
        (drop_path): DropPath()
      )
    )
    (encoder_norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
  )
  (avgpool): AdaptiveAvgPool1d(output_size=1)
  (value_Linear_1): Linear(in_features=134, out_features=256, bias=True)
  (act): GELU(approximate='none')
  (value_Linear_2): Linear(in_features=256, out_features=128, bias=True)
  (value_Linear_3): Linear(in_features=128, out_features=1, bias=True)
  (softmax): Softmax(dim=-1)
)
2025-03-08 04:48:00, INFO: Current learning rate: 0.010000
2025-03-08 04:48:02, INFO: human number: 4
2025-03-08 04:48:02, INFO: running 1/4 episode, simulation environment: no
2025-03-08 04:48:03, INFO: 1/4 episode: Success! Total Reward: 27.458, R_dan: 0.096, R_goal: 10.0, R_col: 0, R_km: 2.39, R_col_wall: 0, R_wall_min_dist: -2.646, R_stop_t: -0.07, R_forward: -0.8, R_way_point_dist: 2.88, R_way_point_dir: 4.346, R_wp: 11.25
2025-03-08 04:48:03, INFO: Path length: 72.28361996542249
2025-03-08 04:48:03, INFO: Path left: 0
2025-03-08 04:48:03, INFO: Actions: 96
2025-03-08 04:48:03, INFO: Coordinates: -10.545448623597622 31.116396620869637
2025-03-08 04:48:03, INFO: Stops times: 7

2025-03-08 04:48:05, INFO: human number: 4
2025-03-08 04:48:06, INFO: running 2/4 episode, simulation environment: circle_crossing
2025-03-08 04:48:06, INFO: 2/4 episode: Collision! Total Reward: 10.84, R_dan: 0.074, R_goal: 0, R_col: -0.25, R_km: 2.22, R_col_wall: 0, R_wall_min_dist: 0.184, R_stop_t: 0, R_forward: -0.74, R_way_point_dist: 2.22, R_way_point_dir: 3.393, R_wp: 3.75
2025-03-08 04:48:06, INFO: Path length: 43.85321733641214
2025-03-08 04:48:06, INFO: Path left: 34.51628727194687
2025-03-08 04:48:06, INFO: Actions: 74
2025-03-08 04:48:06, INFO: Coordinates: 3.7628407683223486 12.82579268142581
2025-03-08 04:48:06, INFO: Stops times: 0

2025-03-08 04:48:08, INFO: human number: 4
2025-03-08 04:48:08, INFO: running 3/4 episode, simulation environment: circle_static
2025-03-08 04:48:09, INFO: 3/4 episode: Success! Total Reward: 34.506, R_dan: 0.128, R_goal: 10.0, R_col: 0, R_km: 4.06, R_col_wall: 0, R_wall_min_dist: 0.246, R_stop_t: -0.02, R_forward: -1.26, R_way_point_dist: 4.2, R_way_point_dir: 5.912, R_wp: 11.25
2025-03-08 04:48:09, INFO: Path length: 76.88858954493662
2025-03-08 04:48:09, INFO: Path left: 0
2025-03-08 04:48:09, INFO: Actions: 140
2025-03-08 04:48:09, INFO: Coordinates: -8.380518324673176 30.790557853877544
2025-03-08 04:48:09, INFO: Stops times: 2

2025-03-08 04:48:11, INFO: human number: 4
2025-03-08 04:48:11, INFO: running 4/4 episode, simulation environment: no
2025-03-08 04:48:11, INFO: 4/4 episode: Success! Total Reward: 27.458, R_dan: 0.096, R_goal: 10.0, R_col: 0, R_km: 2.39, R_col_wall: 0, R_wall_min_dist: -2.646, R_stop_t: -0.07, R_forward: -0.8, R_way_point_dist: 2.88, R_way_point_dir: 4.346, R_wp: 11.25
2025-03-08 04:48:11, INFO: Path length: 72.28361996542249
2025-03-08 04:48:11, INFO: Path left: 0
2025-03-08 04:48:11, INFO: Actions: 96
2025-03-08 04:48:11, INFO: Coordinates: -10.545448623597622 31.116396620869637
2025-03-08 04:48:11, INFO: Stops times: 7

2025-03-08 04:48:11, INFO: TRAIN has success rate: 0.75, collision rate: 0.25, timeout rate: 0.00, collisionwall rate: 0.00, nav time: 27.67, average speed: 2.67, path length: 73.82, total reward: 0.6807
2025-03-08 04:48:11, INFO: In each scenarios, TRAIN has success rate: 1.00 0.00, collision rate: 0.00 1.00, timeout rate: 0.00 0.00, collisionwall rate: 0.00 0.00, nav time: 24.00 0.00, average speed: 3.01 0.00, path length: 72.28 0.00, total reward: 0.6718 0.7197
