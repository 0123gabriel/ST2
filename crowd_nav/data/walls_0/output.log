2025-03-19 18:43:44, INFO: Using device: cuda:0
2025-03-19 18:43:44, INFO: Policy: st2 w/ global state
2025-03-19 18:43:44, INFO: human number: 4
2025-03-19 18:43:44, INFO: Randomize human's radius and preferred speed
2025-03-19 18:43:44, INFO: Training simulation: circle_crossing, test simulation: circle_crossing
2025-03-19 18:43:44, INFO: Square width: 10.0, circle width: 8.0
2025-03-19 18:43:44, INFO: Using model: Spatial_Temporal_Transformer(
  (Embedding): Embedding(
    (embedding): Linear(in_features=14, out_features=128, bias=True)
    (dropout): Dropout(p=0.1, inplace=False)
  )
  (temporal_encoder): Encoder(
    (layers): ModuleList(
      (0): EncoderLayer(
        (attn_norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (attn): Attention(
          (qkv): Linear(in_features=128, out_features=384, bias=True)
          (out): Linear(in_features=128, out_features=128, bias=True)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (proj_dropout): Dropout(p=0.1, inplace=False)
          (softmax): Softmax(dim=-1)
          (avgpool): AdaptiveAvgPool1d(output_size=1)
        )
        (mlp_norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (mlp): Mlp(
          (fc1): Linear(in_features=128, out_features=512, bias=True)
          (fc2): Linear(in_features=512, out_features=128, bias=True)
          (act): GELU(approximate='none')
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
        (drop_path): DropPath()
      )
    )
    (encoder_norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
  )
  (Spatial_encoder): Encoder(
    (layers): ModuleList(
      (0): EncoderLayer(
        (attn_norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (attn): Attention(
          (qkv): Linear(in_features=128, out_features=384, bias=True)
          (out): Linear(in_features=128, out_features=128, bias=True)
          (attn_dropout): Dropout(p=0.1, inplace=False)
          (proj_dropout): Dropout(p=0.1, inplace=False)
          (softmax): Softmax(dim=-1)
          (avgpool): AdaptiveAvgPool1d(output_size=1)
        )
        (mlp_norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        (mlp): Mlp(
          (fc1): Linear(in_features=128, out_features=512, bias=True)
          (fc2): Linear(in_features=512, out_features=128, bias=True)
          (act): GELU(approximate='none')
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
        (drop_path): DropPath()
      )
    )
    (encoder_norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
  )
  (avgpool): AdaptiveAvgPool1d(output_size=1)
  (value_Linear_1): Linear(in_features=135, out_features=256, bias=True)
  (act): GELU(approximate='none')
  (value_Linear_2): Linear(in_features=256, out_features=128, bias=True)
  (value_Linear_3): Linear(in_features=128, out_features=1, bias=True)
  (softmax): Softmax(dim=-1)
)
2025-03-19 18:43:44, INFO: Current learning rate: 0.010000
2025-03-19 18:43:46, INFO: human number: 4
2025-03-19 18:43:46, INFO: running 1/4 episode, simulation environment: no
2025-03-19 18:43:46, INFO: 1/4 episode: Success! Total Reward: 27.458, R_dan: 0.096, R_goal: 10.0, R_col: 0, R_km: 2.39, R_col_wall: 0, R_wall_min_dist: -2.646, R_stop_t: -0.07, R_forward: -0.8, R_way_point_dist: 2.88, R_way_point_dir: 4.346, R_wp: 11.25
2025-03-19 18:43:46, INFO: Path length: 72.28361996542249
2025-03-19 18:43:46, INFO: Path left: 0
2025-03-19 18:43:46, INFO: Actions: 96
2025-03-19 18:43:46, INFO: Coordinates: -10.545448623597622 31.116396620869637
2025-03-19 18:43:46, INFO: Stops times: 7

2025-03-19 18:43:48, INFO: human number: 4
2025-03-19 18:43:48, INFO: running 2/4 episode, simulation environment: circle_crossing
2025-03-19 18:43:48, INFO: 2/4 episode: Collision! Total Reward: 10.879, R_dan: 0.075, R_goal: 0, R_col: -0.25, R_km: 2.18, R_col_wall: 0, R_wall_min_dist: 0.186, R_stop_t: -0.01, R_forward: -0.75, R_way_point_dist: 2.25, R_way_point_dir: 3.458, R_wp: 3.75
2025-03-19 18:43:48, INFO: Path length: 42.8193974250432
2025-03-19 18:43:48, INFO: Path left: 34.80060374225396
2025-03-19 18:43:48, INFO: Actions: 75
2025-03-19 18:43:48, INFO: Coordinates: 3.4442576076835394 12.83624517172575
2025-03-19 18:43:48, INFO: Stops times: 1

2025-03-19 18:43:50, INFO: human number: 4
2025-03-19 18:43:50, INFO: running 3/4 episode, simulation environment: circle_static
2025-03-19 18:43:50, INFO: 3/4 episode: Success! Total Reward: 32.005, R_dan: 0.115, R_goal: 10.0, R_col: 0, R_km: 3.43, R_col_wall: 0, R_wall_min_dist: -0.842, R_stop_t: -0.02, R_forward: -1.05, R_way_point_dist: 3.57, R_way_point_dir: 5.55, R_wp: 11.25
2025-03-19 18:43:50, INFO: Path length: 72.53465693532891
2025-03-19 18:43:50, INFO: Path left: 0
2025-03-19 18:43:50, INFO: Actions: 119
2025-03-19 18:43:50, INFO: Coordinates: -8.836103692650795 31.079019341617823
2025-03-19 18:43:50, INFO: Stops times: 2

2025-03-19 18:43:52, INFO: human number: 4
2025-03-19 18:43:52, INFO: running 4/4 episode, simulation environment: no
2025-03-19 18:43:52, INFO: 4/4 episode: Success! Total Reward: 27.458, R_dan: 0.096, R_goal: 10.0, R_col: 0, R_km: 2.39, R_col_wall: 0, R_wall_min_dist: -2.646, R_stop_t: -0.07, R_forward: -0.8, R_way_point_dist: 2.88, R_way_point_dir: 4.346, R_wp: 11.25
2025-03-19 18:43:52, INFO: Path length: 72.28361996542249
2025-03-19 18:43:52, INFO: Path left: 0
2025-03-19 18:43:52, INFO: Actions: 96
2025-03-19 18:43:52, INFO: Coordinates: -10.545448623597622 31.116396620869637
2025-03-19 18:43:52, INFO: Stops times: 7

2025-03-19 18:43:52, INFO: TRAIN has success rate: 0.75, collision rate: 0.25, timeout rate: 0.00, collisionwall rate: 0.00, nav time: 25.92, average speed: 2.79, path length: 72.37, total reward: 0.6942
2025-03-19 18:43:52, INFO: In each scenarios, TRAIN has success rate: 1.00 0.00, collision rate: 0.00 1.00, timeout rate: 0.00 0.00, collisionwall rate: 0.00 0.00, nav time: 24.00 0.00, average speed: 3.01 0.00, path length: 72.28 0.00, total reward: 0.6718 0.7144
